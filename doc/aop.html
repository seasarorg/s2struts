<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- don't edit start -->
<head><title>Seasar - DI Container with AOP - </title><meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<link href="seasar_b.css" type="text/css" rel="stylesheet"><script src="seasar_b.js" type="text/JavaScript" language="JavaScript"></script>
</head><body onload="preload('ja')"><table width="100%" border="0" cellspacing="0" cellpadding="0" align="left" height="100%"><tr>
<td align="left" valign="top" width="780"><table width="780" border="0" cellspacing="0" cellpadding="0" class="white">
<tr><td colspan="7"><img height="5" width="780" src="images/top01_b.gif" alt=""></td></tr>
<tr><td><img height="117" width="235" src="images/top02_b.gif" alt="Seasar"></td>
<td colspan="3"><img height="117" width="289" src="images/top03.gif" alt="DI Container with AOP"></td>
<td colspan="3"><img height="117" width="256" src="images/spacer.gif" alt=""></td>
</tr><tr><td rowspan="2"><img src="images/top04.gif" alt="" height="49" width="235"></td>
<td><a href="index.html"><img src="images/menu01_b_ja.gif" height="30" width="78" border="0" alt="" id="menu01" onmouseover="swap(1)" onmouseout="restore(1)"></a></td>
<td><a href="http://sourceforge.jp/projects/seasar"><img src="images/menu02_b_ja.gif" height="30" width="101" border="0" alt="" id="menu02" onmouseover="swap(2)" onmouseout="restore(2)"></a></td>
<td><a href="download.html"><img src="images/menu03_b_ja.gif" height="30" width="110" border="0" alt="" id="menu03" onmouseover="swap(3)" onmouseout="restore(3)"></a></td>
<td><a href="document.html"><img src="images/menu04_b_ja.gif" height="30" width="113" border="0" alt="" id="menu04" onmouseover="swap(4)" onmouseout="restore(4)"></a></td>
<td><a href="resource.html"><img src="images/menu05_b_ja.gif" height="30" width="109" border="0" alt="" id="menu05" onmouseover="swap(5)" onmouseout="restore(5)"></a></td>
<td><img height="30" width="34" src="images/menu06.gif" alt=""></td></tr><tr>
<td colspan="6"><img height="19" width="545" src="images/spacer.gif" alt=""></td></tr></table>
<table  width="780" border="0" cellspacing="0" cellpadding="0" height="100%" class="white">
<tr align="left" valign="top"><td width="14"><img height="14" width="14" src="images/spacer.gif" alt=""></td><td width="752" class="main">
<!-- don't edit end -->
<!-- document start -->
	<ul>
		<li><a href="#S2概要">S2AOPの概要</a></li> 
        <ul>
            <li><a href="#Objectorientation">オブジェクト指向</a></li> 
            <li><a href="#objectoriented_problem">オブジェクト指向の問題点</a></li> 
            <li><a href="#AOPKey">AOPを考える上でキーとなる概念</a></li>
			<li><a href="#AOPMerit">AOPのメリット</a></li>
			<li><a href="#S2AOPMerit">S2AOPのメリット</a></li> 
            <li><a href="#Warning">注意点</a></li>
        </ul>
		<li><a href="#S2AOPReference">S2AOPリファレンス</a></li> 
	　　<ul>
            <li><a href="#AOPMakeFile">作成すべきファイル</a></li> 
            <li><a href="#AOPExplanationFile">設定ファイルの説明</a></li>
			<li><a href="#AOPInterceptor">S2AOPで用意されているInterceptor</a></li>
	        <li><a href="#nodicon">diconファイルを使用しないでアスペクトを組み込む方法</a></li>
		</ul>
		<li><a href="#Example">Example</a></li> 
		<ul>
           	<li><a href="#TraceInterceptorSample">TraceInterceptor</a></li> 
           	<li><a href="#ThrowsInterceptorSample">ThrowsInterceptor</a></li> 
           	<li><a href="#DelegateInterceptorSample">DelegateInterceptor</a></li>
		   	<li><a href="#SyncInterceptorSample">SyncInterceptor</a></li>
			<li><a href="#OriginalInterceptorSample">独自実装によるInterceptor</a></li>
        </ul>
	</ul>

	<h2><a name=S2概要>S2AOPの概要</a></h2>
	<p>S2AOPでは、AOPの機能を提供しています。AOPとは、Aspect Oriented Programming (アスペクト指向プログラミング) の略です。プログラム本来の目的とは異なる処理を内部に埋め込まず、外から織り込むように作ることです。現在のオブジェクト指向になぜAOPが必要なのか説明します。</p>
	<h3><a name=Objectorientation>オブジェクト指向</a></h3>
	<p>現在のオブジェクト指向でプログラムを行う場合、下の図のように分けることが出来ます。</p>
	<img src="images/aop01.gif" width="639" height="375" border="0"/>
　　<br />　　　
    <p>オブジェクト指向では顧客からの要求である機能(Core Concern)とロギング機能、宣言的トランザクション、DBコネクションの取得・解放、例外処理、セキュリティ機能や分散処理などの非機能要求(Crosscutting Concern)が同じクラスの同じメソッドの中に実装されることがあります。</p>
    <h3><a name=objectoriented_problem>オブジェクト指向の問題点</a></h3>
    <p>上で挙げているように非機能要求が散在します。この問題点を例に挙げて説明します。<br />
   	例）プログラムを作成したところ、何らかの欠陥が見つかりプログラムの動作がおかしく、どこでおかしくなっているのかは分からないので、プログラム実行中の節目ごとにその途中経過を記録（ロギング）したい場合、ログを書き出すサンプルのコードを以下に示します。太字で書いた場所がログを書き出す場所です。
	
	</p>
<pre>class Foo {
    private Bar bar = new Bar();<br />    public void foo(){<br />        <b>logger.log(&quot;BEGIN Foo#foo&quot;);</b><br />        bar.doSomething();<br />        <b>logger.log(&quot;END Foo#foo&quot;);</b><br />    }<br />}</pre>
<pre>class Bar {
    private Baz baz = new Baz();<br />    public void doSomething(){<br />        <b>logger.log(&quot;BEGIN Bar#doSomething&quot;);</b><br />        baz.doSomething();<br />        <b>logger.log(&quot;END Bar#doSomething&quot;);</b><br />    }<br />}</pre>
    <p>このサンプルのようにロギングするということは、プログラムの複数箇所にその命令を追加する必要があります。また、編集ツールの検索機能などを使って該当箇所を探すとしても、プログラムの書き換えは最終的に手作業となります。これは、次のような問題を引き起こします。</p>
    <ul>
      	<li>処理が複数箇所に分散します。後になって集めたい情報が増えたり、処理そのものが不要になったりすると、それに合わせてすべての場所を変更する必要が出てきます。</li>
      	<li>プログラマが、処理を追加するべきでない場所に追加してしまう可能性があります。</li>
		<li>プログラマが、処理を追加するべき場所に追加し忘れる可能性があります。</li>
		<li>プログラマが、処理として誤ったコードを追加してしまう可能性があります。</li>
		<li>プログラマが、作業中に誤って本来のプログラムを壊してしまう可能性があります。</li>
    </ul>
	<p>
    このロギングの例のように、複数のクラスにまたがった非機能要求の処理を「Crosscutting Concern」と呼びます。「Crosscuting Concern」を分散させないために、モジュール化して取り除き、実行時またはコンパイル時にバイトコードで組み込む仕組みが必要になります。先程のロギングの例をS2AOPを使うと以下のようにXMLの設定をするだけです。ロギングを行う処理をプログラムの複数箇所に追加する必要がなくなります。
    </p>  
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;Shift_JIS&quot;?&gt;
&lt;!DOCTYPE components PUBLIC &quot;-//SEASAR//DTD S2Container//EN&quot;
&quot;http://www.seasar.org/dtd/components.dtd&quot;&gt;
&lt;components&gt;
    &lt;component name=&quot;traceInterceptor&quot; class=&quot;org.seasar.framework.aop.interceptors.TraceInterceptor&quot;/&gt;
    &lt;component class=&quot;Foo&quot;&gt;
        &lt;aspect pointcut=&quot;foo&quot;&gt;traceInterceptor&lt;/aspect&gt;
    &lt;/component&gt;
    &lt;component class=&quot;Bar&quot;&gt;
        &lt;aspect pointcut=&quot;doSomething&quot;&gt;traceInterceptor&lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;
</pre>

	<p>設定ファイルの詳細は、S2AOPリファレンスの<a href="#AOPExplanationFile">設定ファイルの説明</a>を参照してください。</p>
    
<pre>class Foo {
    privaye Bar bar = new Bar();<br />    public void foo(){<br />        bar.doSomething();<br />    }<br />}</pre>
            <pre>class Bar {
    private Baz baz = new Baz();<br />    public void doSomething(){<br />        baz.doSomething();<br />    }<br />}</pre>
         
	<h3><a name=AOPKey>AOPを考える上でキーとなる概念</a></h3>
    <br />
    <h4>Advice(MethodInterceptor)</h4>
	<p>プログラム中に挿入されるコードを表します。Interceptorと呼ばれることもあります。</p>
    <h4>Joinpoint(MethodInvocation)</h4>
    <p>対象となるクラスとAdviceを結合するポイントを表します。AdviceはJoinpointから引数やメソッドの情報を取得することができます。</p>
    <h4>Pointcut</h4>
    <p>どこにJoinpointを設定するのかを定義します。</p>
    <h4>Aspect</h4>
    <p>AdviceとPointcutを関連付けます。</p>
    <h3><a name=AOPMerit>AOPのメリット</a></h3>
    <ul>
		<li>「Core Concern」と「Crosscutting Concern」を分離することでメンテナンス性が向上します。</li>
	　<li>業務ロジックからシステム的機能を「Crosscutting Concern」に排出した「Core Concern」は、シンプルなソースになります。本来のやりたかったことだけが記述されます。</li>
        <li>トランザクションの自動化やリモートメソッド呼び出しなど、従来EJBを使用しなければ実現できなかった処理がPOJO(Plain Old Java Object：特定の環境に依存しない普通のjavaのオブジェクト)で可能になります。</li>　　　
    </ul>
    <h3><a name=S2AOPMerit>S2AOPのメリット</a></h3>
    <ul>
      	<li>設定をシンプルに行えます。</li>
      	<li>実装しなければならないJavaインターフェースが１つです。</li>
      	<li>コンポーネントにどんなアスペクトが適用されるのかが明確です。</li>
      	<li>基本的なAspect実装オブジェクトパターンが用意されているため、すぐに使用することが可能です。(独自にインターフェースや抽象クラスを実装することも可能)</li>　　　　 
    </ul>
	<h3><a name="Warning">注意点</a></h3>
    <ul>
      	<li>finalなクラスにはアスペクトを適用できません。</li>
		<li>finalあるいはstaticなメソッドにはアスペクトを適用できません。</li>
		<li>pointcut属性を指定しない場合、すべてのメソッドが対象になるわけではありません。実装しているインターフェースのすべてのメソッドが対象になります。すべてのメソッドを対象にするには、pointcut属性に".*"と指定します。</li>
    </ul>

	<h2><a name=S2AOPReference>S2AOPリファレンス</a></h2>
    <h3><a name=AOPMakeFile>作成すべきファイル</a></h3>
    <p>S2AOPを使用するにはS2Container の設定ファイル(diconファイル)で行います。設定ファイルの配置場所は、とくに指定がありませんが、通常「Crosscutting Concern」と同じ場所に配置するか、設定を行うコンポーネントと同じ場所に配置します。</p>
    <h3><a name=AOPExplanationFile>設定ファイルの説明</a></h3>
    <h4><a name=aspecTtag>aspectタグ（AOPを使用する場合は必須）</a></h4>
    <p>アスペクトをコンポーネントに組み込みます。Interceptorの指定は、ボディでOGNL式を使うか、子タグでcomponentタグを使います。<br />
    ※OGNLについては <a href="http://www.ognl.org/2.6.7/Documentation/html/LanguageGuide/index.html">OGNLのマニュアル</a>を参照してください。1つのコンポーネントに複数のアスペクトを組み込んだ場合はアスペクトの登録順に組み込まれ実行されます。詳しい説明は<a href="#OriginalInterceptor">独自実装のInterceptor</a>を参照してください。</p>
    <h5>pointcut属性(任意)</h5>            
    <p>カンマ区切りで対象となるメソッド名を指定することができます。pointcutを指定しない場合は、コンポーネントが実装しているインターフェースのすべてのメソッドが対象になります。メソッド名には正規表現(JDK1.4のregex)も使えます。</p>
    <h5>設定例</h5>
    <p>pointcut属性を指定してjava.util.DateのgetTime()メソッドとhashCode()メソッドを対象とする場合以下のようになります。pointcut属性を指定しない場合はjava.util.Dateが実装しているインターフェースのメソッドが対象になります。</p>
            
<pre>&lt;component class=&quot;java.util.Date&quot;&gt;
    &lt;aspect pointcut=&quot;getTime,hashCode&quot;&gt;
        &lt;component class=&quot;org.seasar.framework.aop.interceptors.TraceInterceptor&quot;/&gt;
    &lt;/aspect&gt;
&lt;/component&gt;
</pre>
     正規表現を使ってjava.util.Dateのpublicなメソッドすべてを対象としたい場合は、以下のように設定します。
<pre>&lt;component class=&quot;java.util.Date&quot;&gt;
    &lt;aspect pointcut=&quot;.*&quot;&gt;
        &lt;component class=&quot;org.seasar.framework.aop.interceptors.TraceInterceptor&quot;/&gt;
    &lt;/aspect&gt;
&lt;/component&gt;
</pre>

    <h3><a name=AOPInterceptor>S2AOPで用意されているInterceptor</a></h3>
    <p>S2AOPでは、以下のInterceptorを用意しています。また独自のInterceptorを簡単に作成できるようになっています。</p>
    <h4><a name=TraceInterceptor>(1) TraceInterceptor</a></h4>
    <h5>クラス名</h5>
    <p>org.seasar.framework.aop.interceptors.TraceInterceptor</p>
    <h5>説明</h5>
    <p>トレース処理を「Crosscutting Concern」として扱うためのInterceptorです。DateクラスにTraceInterceptorを適用したdiconファイルは、以下のようになります対象とするメソッドはgetTime()とします。</p>
<pre>&lt;component class=&quot;java.util.Date&quot;&gt;
    &lt;aspect pointcut=&quot;getTime&quot;&gt;
        &lt;component class=&quot;org.seasar.framework.aop.interceptors.TraceInterceptor&quot;/&gt;
    &lt;/aspect&gt;
&lt;/component&gt;
</pre>
    <p>詳しい使用方法は<a href="#TraceInterceptorSample">TraceInterceptor</a>を参照してください。</p>
    <h4>(2) ThrowsInterceptor</h4>
    <h5>クラス名</h5>
    <p>org.seasar.framework.aop.interceptors.ThrowsInterceptor</p>
    <h5>説明</h5>
    <p>例外処理を「Crosscutting concern」として扱うためのInterceptorです。使用するにはThrowsInterceptorを継承し、Object handleThrowable(Throwable, MethodInvocation)を実装するだけです。ThrowableにはThrowableのサブクラスを指定することができます。例えばhandleThrowable(IOException, MethodInvocation)のようにメソッド定義すると、ThrowsInterceptorを適用したコンポーネント内で発生した例外がIOExceptionもしくはIOExceptionのサブクラスの場合に、呼び出されることになります。handleThrowable()はいくつでも定義することができます。詳しい使用方法は<a href="#ThrowsInterceptorSample">ThrowsInterceptor</a>を参照してください。</p>
    <h4>(3) MockInterceptor</h4>
    <h5>クラス名</h5>
    <p>org.seasar.framework.aop.interceptors.MockInterceptor</p>
    <h5>説明</h5>
    <p>Mockを使ったテストを簡単に行うためのInterceptorです。詳しい説明はテスト技法の<a href="http://homepage3.nifty.com/seasar/testtech.html#MockMake">モックを作成するための設定</a>を参照してください。</p>
    <h4>(4) DelegateInterceptor</h4>
    <h5>クラス名</h5>
    <p>org.seasar.framework.aop.interceptors.DelegateInterceptor</p>
    <h5>説明</h5>
    <p>メソッド呼び出しを別のコンポーネントに委譲するためのInterceptorです。使用方法はDelegateInterceptorのtargetプロパティに委譲したい相手を指定します。委譲するときのメソッド名が異なる場合には、DeleateInterceptor#addMethodNameMap(String methodName, String targetMethodName)で指定します。例えば、bar()というメソッドをfoo.bar2()に委譲する場合、DeleateInterceptor#setTarget(foo)，DeleateInterceptor#addMethodNameMap(&quot;bar&quot;, &quot;bar2&quot;)のように指定します。詳しい使用方法は<a href="#DelegateInterceptorSample">DelegateInterceptor</a>を参照してください。</p>
    <h4>(5) SyncInterceptor</h4>
    <h5>クラス名</h5>
    <p>org.seasar.framework.aop.interceptors.SyncInterceptor</p>
    <h5>説明</h5>
    <p>メソッド呼び出しをAspectを使って同期化するためのInterceptorです。ソースを変更することなく、メソッド呼び出しを同期化できます。詳しい使用方法は<a href="#SyncInterceptorSample">SyncInterceptor</a>を参照してください。</p>
    <h4><a name="OriginalInterceptor">(6) 独自実装によるInterceptor</a></h4>
    <h5>説明</h5>
    <p>独自にInterceptorを作成する場合は、次のインターフェースまたは、抽象クラスを実装します。</p>
    <dl>
    	<dt style="text-indent:1em;">org.aopalliance.intercept.MethodInterceptor</dt>
    	<dt style="text-indent:1em;">org.seasar.framework.aop.interceptors.AbstractInterceptor</dt>
    </dl>
    <p>どちらの場合も実装するメソッドは、以下のinvoke()メソッドの１つだけです。</p>
    <dl>
    	<dt style="text-indent:1em;">public Object invoke(MethodInvocation invocation) throws Throwable</dt>
    </dl>
    <p>AbstractInterceptorは、MethodInterceptorをimplementsした抽象クラスです。AbstractInterceptorには、Proxyオブジェクトを取得するcreateProxy()メソッドとアスペクトを適用するクラスを取得するgetTargetClass()メソッドがあります。アスペクトを適用したクラス名を必要とするInterceptor(例えば、ログ出力を行うInterceptor)を作成する場合は、AbstractInterceptorを使用することで簡単にクラス名を取得することができます。</p>
    <dl>
    	<dt style="text-indent:1em;">public Object createProxy(Class proxyClass)</dt>
    	<dt style="text-indent:1em;">protected Class getTargetClass(MethodInvocation invocation)</dt>
    </dl> 
   	<p>MethodInvocationのgetThis()、getMethod()、getArguments()で対象となるオブジェクト、メソッド、引数を取得できます。getThis()でクラス名を取得するとバイトコードで組み込まれたクラス名が取得されます。proceed()を呼び出すと実際のメソッドが呼び出され実行結果を取得することができます。以下のような独自のInterceptorを作成したとします。</p>
    <h5>作成例</h5>
    <img src="images/aop02.gif" width="515" height="263" border="0"/>
    <p>MethodInvocation#proceed()を呼ぶ前と後で2分され、呼ぶ前は Beforeの個所を実行し、呼んだ後はAfterの個所を実行します。1つのコンポーネントに複数のアスペクトが定義されている場合は、以下のよう実行されます。</p>
   	<ol>
    	<li>Aspectの登録順にMethodInterceptorのbefore部分が実行されます。</li>
    	<li>最後のMethodInterceptorのbefore部分を実行した後にコンポーネント自身のメソッドが呼び出されます。</li>
    	<li>Aspectの登録の逆順にMethodInterceptorのafter部分が実行されます。</li>
   	</ol>
    <p>詳しい使用方法は<a href="#OriginalInterceptorSample">独自実装によるInterceptor</a>を参照してください。</p>
    <h3><a name=nodicon>diconファイルを使用しないでアスペクトを組み込む方法</a></h3>
    <p>diconファイルの設定を行わずプログラム上でアスペクトを組み込むこともできます。作成方法は次のようになります。</p>
    <ul>
	    <li>org.seasar.framework.aop.impl.PointcutImplのコンストラクタの引数で対象となるメソッド名を指定(複数可)します。java.util.HashMapのようにインターフェースを実装しているなら、new PointcutImpl(HashMap.class)のようにクラスを指定することで、そのクラスが実装しているインターフェースのメソッドをすべて自動的に適用させることもできます。</li>
        <li>org.seasar.framework.aop.impl.AspectImplのコンストラクタの第1引数にInterceptorを指定して、第2引数にPointcutImplで作成したPointcutを指定します。</li>
        <li>org.seasar.framework.aop.proxy.AopProxyのコンストラクタで、対象となるクラスとAspectImplで作成したAspectの配列を指定します。</li>
        <li>org.seasar.framework.aop.proxy.AopProxy#create()でAspectが適用されたオブジェクトを取得できます。</li>
	</ul>
    <p>java.util.DateクラスにTraceInterceptorをプログラム上で適用する場合は、次のようになります。対象となるメソッドはgetTime()とします。</p>
<pre>Pointcut pointcut = new PointcutImpl(new String[]{"getTime"});
Aspect aspect = new AspectImpl(new TraceInterceptor(), pointcut);
AopProxy aopProxy = new AopProxy(Date.class, new Aspect[]{aspect});
Date proxy = (Date) aopProxy.create();
proxy.getTime();
</pre>
	<h2><a name=Example>Example</a></h2>
	<p>以下のサンプルを実行する場合は、<a href="http://homepage3.nifty.com/seasar/setup.html">セットアップ</a>を行う必要があります。</p>
    <h3><a name=TraceInterceptorSample>TraceInterceptor</a></h3>
    <p>TraceInterceptorを使用してjava.util.ArrayListクラスとjava.util.DateクラスのgetTime()メソッドとhashCode()メソッドが呼ばれた場合にトレースを出力させましょう。作成するファイルは以下のとおりです。</p>
    <ul>
    	<li type="circle">コンポーネントを定義するdiconファイル(Trace.dicon)</li>
		<li type="circle">設定が正しく行われているか確認する実行javaファイル(AopTraceClient.java)</li>
	</ul>
    <p><b>diconファイルの作成</b></p>
    <ul>
        <li type="circle">TraceInterceptorをコンポーネント定義します。name属性をtraceInterceptorとします。</li>
	    <li type="circle">java.util.ArrayListクラスのコンポーネントの定義します。aspectタグにInterceptorを指定します。</li>
        <li type="circle">java.util.Dateクラスのコンポーネントの定義します。pointcut属性にgetTime()メソッドとhashCode()メソッドを指定します。argタグを使用してjava.util.Dateクラスのコンストラクタに0を設定します。aspectタグにInterceptorを指定します。</li>
    </ul>
	<p>Trace.dicon</p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;Shift_JIS&quot;?&gt;
&lt;!DOCTYPE components PUBLIC &quot;-//SEASAR//DTD S2Container//EN&quot;
&quot;http://www.seasar.org/dtd/components.dtd&quot;&gt;
&lt;components&gt;
    &lt;component name=&quot;traceInterceptor&quot; class=&quot;org.seasar.framework.aop.interceptors.TraceInterceptor&quot;/&gt;
    &lt;component class=&quot;java.util.ArrayList&gt;
        &lt;aspect&gt;traceInterceptor&lt;/aspect&gt;
    &lt;/component&gt;
    &lt;component class=&quot;java.util.Date&quot;&gt;
        &lt;arg&gt;0&lt;/arg&gt;
        &lt;aspect pointcut=&quot;getTime, hashCode&quot;&gt;
            traceInterceptor
        &lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;
</pre>
	<p><b>実行ファイルの作成</b></p>
    <ul>
		<li type="circle">org.seasar.framework.container.S2Container#create()メソッドの最初の引数に作成したdiconファイル(Trace.dicon)のパスを指定してコンテナを作成します。</li>
        <li type="circle">org.seasar.framework.container.S2Container#getComponent()メソッドの第１引数にコンポーネントに登録したクラス名（ArrayList.class、Date.class)を指定してコンポーネントを取得します。</li>
        <li type="circle">トレースがAspectされるか確認するために取得したコンポーネントのArrayListのsize()メソッドを実行します。</li>
        <li type="circle">同様に取得したコンポーネントのDateのgetTime()メソッド、hashCode()メソッドを実行します。</li>
	</ul>
    <p>AopTraceClient.java</p>           
<pre>
package examples.aop.traceinterceptor;

import java.util.Date;
import java.util.List;

import org.seasar.framework.container.S2Container;
import org.seasar.framework.container.factory.S2ContainerFactory;

public class AopTraceClient {
    private static String PATH = &quot;examples/aop/traceinterceptor/Trace.dicon&quot;;

    public static void main(String[] args) {
        S2Container container = S2ContainerFactory.create(PATH);
        List list = (List) container.getComponent(List.class);
        list.size();
        Date date = (Date) container.getComponent(Date.class);
        date.getTime();
        date.hashCode();
    }
}
</pre>
	<p><b>実行結果</b></p>
    <p>メソッドが呼ばれる前と後でトレースが出力されているのが確認できます。また、java.util.DateのhashCode()メソッドはメソッド内でgetTime()メソッドを呼んでいるのでhashCode()メソッドとgetTime()メソッドがトレースされていることが確認できます。</p>
<pre>
BEGIN java.util.ArrayList#size()
END java.util.ArrayList#size() : 0
BEGIN java.util.Date#getTime()
END java.util.Date#getTime() : 0
BEGIN java.util.Date#hashCode()
BEGIN java.util.Date#getTime()
END java.util.Date#getTime() : 0
END java.util.Date#hashCode() : 0
</pre>
	<p>このサンプルは、seasar2/src/examples/aop/traceinterceptor以下に用意されています。</p>
	<br />
	<h3><a name=ThrowsInterceptorSample>ThrowsInterceptor</a></h3>
	<p>(1) ThrowsInterceptorを使って、例外が発生した場合でも処理を続けられるようにしましょう。作成するファイルは以下のようになります。</p>
	<ul>
		<li type="circle">RuntimeExceptionを発生させるクラス(Checker.java)</li>
		<li type="circle">ThrowsInterceptorを継承して作成するInterceptor(HandleThrowableInterceptor.java)</li>
		<li type="circle">コンポーネントの定義をするdiconファイル(Checker.dicon)</li>
		<li type="circle">設定が正しく行われているか確認する実行ファイル(AopCheckerClient.java)</li>
	</ul>
    <p><b>例外を発生させるクラスの作成</b></p>
    <ul>
     	<li type="circle">run()メソッドの引数がnullでは無い場合は、引数の文字をコンソールに出力します。</li>
		<li type="circle">引数がnullの場合は、NullPointerExceptionを発生させます。</li>
	</ul>
    <p>Checker.java</p>
<pre>
package examples.aop.throwsinterceptor;

public class Checker {
    public void check(String str) {
        if (str != null) {
            System.out.println(str);
        } else {
            throw new NullPointerException(&quot;null&quot;);
        }
    }
}
</pre>
	<p><b>ThrowsInterceptorを継承するInterceptorの作成</b></p>
	<ul>
        <li type="circle">ThrowsInterceptorを継承します。</li>
	    <li type="circle">handleThrowable(Throwable, MethodInvocation)を実装します。</li>
    </ul>
	<p>HandleThrowableInterceptor.java</p>
<pre>
package examples.aop.throwsinterceptor;

import org.aopalliance.intercept.MethodInvocation;
import org.seasar.framework.aop.interceptors.ThrowsInterceptor;

public class HandleThrowableInterceptor extends ThrowsInterceptor {
    public void handleThrowable(Throwable t, MethodInvocation invocation)
        throws Throwable {
    }
}
</pre>
    <p><b>diconファイルの作成</b></p>
	<ul>
    	<li type="circle">作成したInterceptorをコンポーネント定義します。name属性をhandleThrowableInterceptorとします。</li>
		<li type="circle">例外を発生させるCheckerクラスのcheck()メソッドに作成したHandleThrowableInterceptorをアスペクトします。</li>
	</ul>
    <p>Checker.dicon</p>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;Shift_JIS&quot;?&gt;
&lt;!DOCTYPE components PUBLIC &quot;-//SEASAR//DTD S2Container//EN&quot;
&quot;http://www.seasar.org/dtd/components.dtd&quot;&gt;
&lt;components&gt;
    &lt;component name=&quot;handleThrowableInterceptor&quot; 
               class=&quot;examples.aop.throwsinterceptor.HandleThrowableInterceptor&quot;/&gt;
    &lt;component class=&quot;examples.aop.throwsinterceptor.Checker&quot;&gt;
        &lt;aspect pointcut=&quot;check&quot;&gt;
            handleThrowableInterceptor
        &lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;
</pre>
    <p><b>実行ファイルの作成</b></p>
    <ul>
        <li type="circle">org.seasar.framework.container.S2Container#create()メソッドの第１引数に作成したdiconファイル(Checker.dicon)のパスを指定してコンテナを作成します。</li>
        <li type="circle">org.seasar.framework.container.S2Container#getComponent()メソッドの第１引数にコンポーネントに登録したクラス名（Foo.class)を指定して取得します。</li>
        <li type="circle">Checker#check()メソッドの引数に&quot;foo&quot;の文字列を渡します。</li>
        <li type="circle">Checker#check()メソッドの引数にnullを渡して例外を発生させます。</li>
        <li type="circle">Checker#check()メソッドの引数に&quot;hoge&quot;の文字列を渡します。</li>
    </ul>
    <p>AopCheckerClient.java</p>
<pre>package examples.aop.throwsinterceptor;

import org.seasar.framework.container.S2Container;
import org.seasar.framework.container.factory.S2ContainerFactory;

public class AopCheckerClient {
    private static String PATH = &quot;examples/aop/throwsinterceptor/Checker.dicon&quot;;

    public static void main(String[] args) {
        S2Container container = S2ContainerFactory.create(PATH);
        Checker checker = (Checker) container.getComponent(Checker.class);
        checker.check(&quot;foo&quot;);
        checker.check(null);
        checker.check(&quot;hoge&quot;);
    }
}</pre>
	<p><b>実行結果</b></p>
	<p>&quot;hoge&quot;が表示されていることから例外で処理が止まっていないことが確認できます。</p>
<pre>foo
hoge
</pre>
	<p>このサンプルは、seasar2/src/examples/aop/throwsinterceptorr以下に用意されています。</p>
    <br />
    <p>(2) 例外を別の例外に変換するInterceptorを作成して変換したメッセージを表示させましょう。作成するInterceptorは、先ほどThrowsInterceptorを継承して作成したクラス(HandleThrowableInterceptor.java)を応用して作成しましょう</p>
 　 <b>例外を別の例外に変換するInterceptorの作成</b>
    <p>handleThrowable(Throwable, MethodInvocation)メソッドの第1引数がNullPointerExceptionの場合、org.seasar.framework.exception.SRuntimeExceptionを発生させてメッセージを変更します。</p>
<pre>
package examples.aop.throwsinterceptor;

import org.aopalliance.intercept.MethodInvocation;
import org.seasar.framework.aop.interceptors.ThrowsInterceptor;
import org.seasar.framework.exception.SRuntimeException;

public class HandleThrowableInterceptor extends ThrowsInterceptor {
    public void handleThrowable(NullPointerException t, MethodInvocation invocation)
            throws Throwable {
        throw new SRuntimeException(&quot;ESSR0007&quot;, new Object[] { &quot;引数&quot; });
    }
}
</pre>
	<p>先ほど作成した実行ファイルを使って実行します。</p>
    <b>実行結果</b>
    <p>エラーメッセージが変わっているのが確認できます。</p>
<pre>
foo
org.seasar.framework.exception.SRuntimeException: [ESSR0007]引数はnullあるいは空であってはいけません
	at examples.aop.throwsinterceptor.HandleThrowableInterceptor.
handleThrowable(HandleThrowableInterceptor.java:11)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:324)
	at org.seasar.framework.aop.interceptors.ThrowsInterceptor.invoke(ThrowsInterceptor.java:55)
	at org.seasar.framework.aop.impl.MethodInvocationImpl.proceed(MethodInvocationImpl.java:60)
	at org.seasar.framework.aop.proxy.AopProxy.intercept(AopProxy.java:123)
	at examples.aop.throwsinterceptor.Checker$$EnhancerByCGLIB$$8cdef299.check(&lt;generated&gt;)
	at examples.aop.throwsinterceptor.AopCheckerClient.main(AopCheckerClient.java:13)
Exception in thread &quot;main&quot;
</pre>
	<p>このサンプルは、seasar2/src/examples/aop/throwsinterceptorr以下に用意されています。</p>
<h3><a name=DelegateInterceptorSample>DelegateInterceptor</a></h3>
    <p>S2AOPで用意されているDelegateInterceptorを使って、他のクラスのメソッドに委譲させましょう。<br />
    ここでは、インターフェースで抽象メソッドを作成して、抽象クラスと普通のクラスの両方にそのインターフェースを実装させます。抽象クラスで実装したメソッドを普通のクラスで実装したメソッドに委譲させましょう。作成するファイルは以下のとおりです。</p>
    <ul>
		<li type="circle">インターフェース(IBase.java)</li>
		<li type="circle">インターフェースを実装した抽象クラス(Dummy.java)</li>
		<li type="circle">インターフェースを実装したクラス(Substance.java)</li>
		<li type="circle">委譲を設定するdiconファイル(Delegate.dicon)</li>
		<li type="circle">設定が正しく行われているか確認する実行ファイル(AopDelegateClient.java)</li>
	</ul>
    <p><b>インターフェースの作成</b></p>
	<ul>
	    <li type="circle">抽象メソッドを作成します。</li>
	</ul>
    <p>IBase.java</p>
<pre>package examples.aop.delegateinterceptor;

public interface IBase {
    public abstract void run();
}</pre>

	<p><b>インターフェースを実装した抽象クラスの作成</b></p>
	<ul>
		<li type="circle">作成したインターフェースを実装します。</li>
	</ul>
    <p>Dummy.java</p>
<pre>package examples.aop.delegateinterceptor;

public abstract class Dummy implements IBase {
}</pre>
    <p><b>インターフェースを実装したクラスの作成</b></p>
	<ul>
		<li type="circle">作成したインターフェースを実装します。</li>
		<li type="circle">実装したインタフェースの抽象メソッドの実装します。</li>
	</ul>
	<p>Substance.java</p>
<pre>package examples.aop.delegateinterceptor;

public class Substance implements IBase {
    public void run() {
        System.out.println(&quot;substance&quot;);
    }
}</pre>
	<p><b>diconファイルの作成</b></p>
	<ul>
		<li type="circle">抽象クラス(Dummy.java)をコンポーネント定義します。</li>
        <li type="circle">DelegateInterceptorのコンポーネントをaspectタグに定義します。DelegateInterceptor#setTarget()を使って委譲したい相手を指定します。委譲したいクラスはexamples.aop.delegateinterceptor.Substanceクラスなのでメソッド・インジェクションを使ってセットします。</li>
	</ul>            
	<p>Delegate.dicon</p>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;Shift_JIS&quot;?&gt;
&lt;!DOCTYPE components PUBLIC &quot;-//SEASAR//DTD S2Container//EN&quot;
&quot;http://www.seasar.org/dtd/components.dtd&quot;&gt;
&lt;components&gt;
    &lt;component class=&quot;sample.aop.delegateinterceptor.Dummy&quot;&gt;
        &lt;aspect&gt;
            &lt;component class=&quot;org.seasar.framework.aop.interceptors.DelegateInterceptor&quot;&gt;
                &lt;initMethod name=&quot;setTarget&quot;&gt;
                    &lt;arg&gt;new sample.aop.delegateinterceptor.Substance()&lt;/arg&gt;
                &lt;/initMethod&gt;
            &lt;/component&gt;
        &lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;</pre>
	<p><b>実行ファイルの作成</b></p>
	<ul>
    	<li type="circle">org.seasar.framework.container.S2Container#create()メソッドの最初の引数に作成したdiconファイル(Delegate.dicon)のパスを指定してコンテナを作成します。</li>
        <li type="circle">org.seasar.framework.container.S2Container#getComponent()メソッドの第１引数にコンポーネントに登録したクラス名（IBase.class)を指定して取得します。</li>
        <li type="circle">コンテナから取得したIBase#run()メソッドを実行します。</li>
	</ul>
    AopDelegateCilent.dicon
<pre>package examples.aop.delegateinterceptor;

import org.seasar.framework.container.S2Container;
import org.seasar.framework.container.factory.S2ContainerFactory;

public class AopDelegateClient {
    private static String PATH = &quot;examples/aop/delegateinterceptor/Delegate.dicon&quot;;
    public static void main( String[] args ){
        S2Container container = S2ContainerFactory.create(PATH);
        IBase base = (IBase) container.getComponent(Dummy.class);
        base.run();
    }
}</pre>

	<p><b>実行結果</b></p>
	<p>コンソールに&quot;substance&quot;と表示されているのでDummy#run()がSubstance#run()に委譲されているのが確認できます。</p>
<pre>
substance
</pre>	
	<p>このサンプルは、seasar2/src/examples/aop/delegateinterceptor以下に用意されています。</p>
    <br />
    <h3><a name=SyncInterceptorSample>SyncInterceptor</a></h3>
    <p>SyncInterceptorを使って、同期を取りましょう。<br />
    まずは、SyncInterceptorを適用しない場合のサンプルを作成しましょう。複数のスレッドが共有オブジェクトにアクセスして、ある変数に1加算するクラスを作成しましょう。作成するファイルは以下のとおりです。</p>
    <ul>	
		<li type="circle">ある変数に1加算するインターフェース(Count.java)</li>
		<li type="circle">インターフェースを実装するクラス(CountImpl.java)</li>
		<li type="circle">コンポーネントの定義を行うdiconファイル(SyncCalc.dicon)</li>
		<li type="circle">設定が正しく行われているか確認する実行ファイル(AopSyncClient.java)</li>
	</ul>
	<b>ある変数に1加算するインターフェース作成</b>
	<ul>
		<li type="circle">加算するメソッドを作成します。</li>
		<li type="circle">カウント数を取得するメソッドを作成します。</li>
	</ul>
	<p>Count.java</p>
<pre>
package examples.aop.syncinterceptor;

public interface Count {

    public void add();
	
    public int get();
}
</pre>
	<p><b>インターフェースの実装クラス</b></p>
    <ul>
		<li type="circle">インターフェースを実装します。</li>
		<li type="circle">加算していく変数を宣言します。初期値は0とします。</li>
		<li type="circle">インターフェースのadd()メソッドを実装して、処理はスレッドを2秒間止めてから変数に1加算するようにする。また、加算する前の数値を表示します。</li>
		<li type="circle">インターフェースのget()メソッドを実装して、処理は変数の値を返すようにします。</li>
    </ul>
	<p>CountImpl.java</p>
<pre>
package examples.aop.syncinterceptor;

public class CountImpl implements Count {
    private int _count = 0;

    public void add() {
        int a = _count;

        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        _count = a + 1;
        System.out.println(a);
    }

    public int get() {
        return _count;
    }
}
</pre>
	<p><b>diconファイルの作成</b></p>
	<ul>
    	<li type="circle">作成したCountImplをコンポーネント定義します。</li>
	</ul>
	<p>Count.dicon</p>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;Shift_JIS&quot;?&gt;
&lt;!DOCTYPE components PUBLIC &quot;-//SEASAR//DTD S2Container//EN&quot;
&quot;http://www.seasar.org/dtd/components.dtd&quot;&gt;
&lt;components&gt;
    &lt;component class=&quot;examples.aop.syncinterceptor.CountImpl&quot;&gt;
    &lt;/component&gt;
&lt;/components&gt;</pre>

    <p><b>実行ファイルの作成</b></p>
	<ul>
		<li type="circle">org.seasar.framework.container.S2Container#create()メソッドの第１引数に作成したdiconファイル(SyncCalc.dicon)のパスを指定してコンテナを作成します。</li>
    	<li type="circle">org.seasar.framework.container.S2Container#getComponent()メソッドの第１引数にコンポーネントに登録したクラス名（Count.class)を指定して取得します。</li>
		<li type="circle">Runnableを作成する。その際にThread が実行する処理のrun()メソッドにCountクラスのadd()メソッドの処理を行うようにします。</li>
		<li type="circle">Threadを5つ作成します。</li>
		<li type="circle">Thread#start()メソッドで作成した5つのスレッドを実行可能状態にします。</li>
        <li type="circle">Thread#join()メソッドを使って当該スレッドが終了するまで、呼び出し元のスレッドを待機します。</li>
        <li type="circle">すべてのスレッドが呼ばれたら、カウント数を表示します。</li>
	</ul>
    <p>AopSyncClient.java</p>
<pre>package examples.aop.syncinterceptor;

import org.seasar.framework.container.S2Container;
import org.seasar.framework.container.factory.S2ContainerFactory;

public class AopSyncClient {
    private String PATH = &quot;examples/aop/syncinterceptor/SyncCalc.dicon&quot;;
    private Count _count = null;
        
    public void init() {
        S2Container container = S2ContainerFactory.create(PATH);
        _count = (Count) container.getComponent(Count.class);
    }
        
    public void start() {
        System.out.println(&quot;count: &quot; + _count.get());

        Runnable r = new Runnable() {
            public void run() {
                _count.add();
            }
        };
        Thread[] thres = new Thread[5];
        for (int i=0; i&lt;5; i++) {
            thres[i] = new Thread(r);
            thres[i].start();
        }
        for (int i=0; i&lt;5; i++) {
            try {
                thres[i].join();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

        System.out.println(&quot;count: &quot; + _count.get());
    }
        
    public static void main(String[] args) {
        AopSyncClient asc = new AopSyncClient();
        asc.init();
        asc.start();
    }
}</pre>

	<p><b>実行結果</b></p>
	<p>同期が取れていないことが確認できます。</p>
<pre>count: 0
0
0
0
0
0
count: 1
</pre>
	<b>SyncInterceptorを適用して同期が取れるようにしましょう。</b>
	<ul>
		<li type="circle">diconファイルに定義したコンポーネントにSyncInterceptorをアスペクトします。</li>
	</ul>
	<p>Count.dicon</p>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;Shift_JIS&quot;?&gt;
&lt;!DOCTYPE components PUBLIC &quot;-//SEASAR//DTD S2Container//EN&quot;
&quot;http://www.seasar.org/dtd/components.dtd&quot;&gt;
&lt;components&gt;
    &lt;component class=&quot;examples.aop.syncinterceptor.CountImpl&quot;&gt;
        &lt;aspect&gt;
            &lt;component class=&quot;org.seasar.framework.aop.interceptors.SyncInterceptor&quot;/&gt;
        &lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;</pre>
	<p><b>実行結果</b></p>
    <p>１ずつ加算されていることから同期が取れていることが確認できます。</p>
<pre>count: 0
0
1
2
3
4
count: 5</pre>
	<p>このサンプルは、seasar2/src/examples/aop/syncinterceptor以下に用意されています。</p>
    <br />
    <h3><a name=OriginalInterceptorSample>独自実装によるInterceptor</a></h3>
    <p>クラス名、メソッド名、引数とメソッドの処理時間を計測してトレースするInterceptorを作成しましょう。また、そのInterceptorを使用して重い処理を行った時間をトレースさせましょう。作成するファイルは以下のとおりです。</p>
    <ul>
		<li type="circle">クラス名、メソッド名、引数とメソッドの処理時間を計測して出力するInterceptor(MeasurementInterceptor.java)</li>
    	<li type="circle">重い処理を行うクラス(HeavyProcess.java)</li>
    	<li type="circle">コンポーネントの定義を行うdiconファイル(Measurement.dicon)</li>
    	<li type="circle">設定が正しく行われているか確認する実行ファイル(AopMeasurementClient.java)</li>
    </ul>
	<p><b>独自実装のIntercepterの作成</b></p>
	<ul>
    	<li type="circle">org.seasar.framework.aop.interceptors.AbstractInterceptorクラスを実装します。</li>
	    <li type="circle">invoke(MethodInvocation invocation)メソッドを実装します。</li>
        <li type="circle">getTargetClass(invocation).getName()でクラスの完全限定名を取得します。MethodInvocation#getThis()だとバイトコードで変換されて組み込まれたクラス名になります。</li>
        <li type="circle">invocation.getMethod().getName()でメソッド名を取得します。</li>
        <li type="circle">invocation.getArguments()で引数を取得します。</li>
        <li type="circle">invocation.proceed()で実際のメソッドが呼ばれるので、その前の時間を取得します。</li>
        <li type="circle">invocation.proceed()で実際のメソッドが呼ばれた後の時間を取得してfinallyで出力します。</li>
	</ul>
    <p>MeasurementInterceptor.java</p>
<pre>package examples.aop.originalinterceptor;

import org.aopalliance.intercept.MethodInvocation;
import org.seasar.framework.aop.interceptors.AbstractInterceptor;

public class MeasurementInterceptor extends AbstractInterceptor{
    public Object invoke(MethodInvocation invocation) throws Throwable {
        long start = 0;
        long end = 0;
        StringBuffer buf = new StringBuffer(100);
                
        buf.append(getTargetClass(invocation).getName());
        buf.append(&quot;#&quot;);
        buf.append(invocation.getMethod().getName());
        buf.append(&quot;(&quot;);
        Object[] args = invocation.getArguments(); 
        if (args != null &amp;&amp; args.length &gt; 0) { 
            for (int i = 0; i &lt; args.length; ++i) {
                buf.append(args[i]);
                buf.append(&quot;, &quot;);
            }
            buf.setLength(buf.length() - 2);
        }
        buf.append(&quot;)&quot;);
        try {
            start = System.currentTimeMillis();
            Object ret = invocation.proceed();
            end = System.currentTimeMillis();
            buf.append(&quot; : &quot;);
            return ret;
        } catch (Throwable t) {
            buf.append(&quot; Throwable:&quot;);
            buf.append(t);
            throw t;
        } finally {
            System.out.println(buf.toString() + (end - start));
        }
    }
}</pre>

    <p><b>重い処理を行うクラスの作成</b></p>
	<ul>
		<li type="circle">重い処理を行ったということにするために5秒間sleepします。</li>
	</ul>
    <p>HeavyProcess.java</p>
<pre>package examples.aop.originalinterceptor;

public class HeavyProcess {
    public void heavy(){
        try{
            Thread.sleep(5000);
        } catch (InterruptedException ex) {
            ex.printStackTrace();
        }
    }
}</pre>

    <b>diconファイルの作成</b>
	<ul>
        <li type="circle">作成したMeasurementInterceptorをコンポーネント定義します。name属性をmeasurementとします。</li>
		<li type="circle">HeavyProcessクラスのheavy()メソッドにMeasurementInterceptorをaspectします。</li>
	</ul>
    <p>Measurement.dicon</p>

<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;Shift_JIS&quot;?&gt;
&lt;!DOCTYPE components PUBLIC &quot;-//SEASAR//DTD S2Container//EN&quot;
&quot;http://www.seasar.org/dtd/components.dtd&quot;&gt;
&lt;components&gt;
    &lt;component name=&quot;measurement&quot; class=&quot;examples.aop.originalinterceptor.MeasurementInterceptor&quot;/&gt;
    &lt;component class=&quot;examples.aop.originalinterceptor.HeavyProcess&quot;&gt;
        &lt;aspect pointcut=&quot;heavy&quot;&gt;
               measurement
        &lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;
</pre>

	<p><b>実行ファイルの作成</b></p>
    <ul>
    	<li type="circle">org.seasar.framework.container.S2Container#create()メソッドの第１引数に作成したdiconファイル(Measurement.dicon)のパスを指定してコンテナを作成します。</li>
        <li type="circle">org.seasar.framework.container.S2Container#getComponent()メソッドの第１引数にコンポーネントに登録したクラス名（HeavyProcess.class)を指定して取得します。</li>
        <li type="circle">コンテナから取得したHeavyProcess#heavy()メソッドを実行します。</li>
	</ul>
    <p>AopMeasurementClient.java</p>
<pre>
package examples.aop.originalinterceptor;

import org.seasar.framework.container.S2Container;
import org.seasar.framework.container.factory.S2ContainerFactory;

public class AopMeasurementClient {
    private static String PATH = &quot;examples/aop/originalinterceptor/Measurement.dicon&quot;;

    public static void main(String[] args) {
        S2Container container = S2ContainerFactory.create(PATH);
        HeavyProcess heavyProcess = (HeavyProcess) container
                .getComponent(HeavyProcess.class);
        heavyProcess.heavy();
    }
}
</pre>

	<p><b>実行結果</b></p>
    <p>クラス名、メソッド名、引数とメソッドの処理時間がトレースされているのが確認できます。</p>
<pre>
examples.aop.HeavyProcess#heavy() : 5004
</pre>
	<p>このサンプルは、seasar2/src/examples/aop/originalinterceptor以下に用意されています。</p>

<!-- document end -->
<!-- don't edit start -->
</td>
<td width="14"><img height="14" width="14" src="images/spacer.gif" alt=""></td>
</tr><tr>
<td width="14"><img height="30" width="14" src="images/spacer.gif" alt=""></td>
<td width="766"><img height="30" width="592" src="images/spacer.gif" alt=""></td></tr><tr>
<td width="14"><img height="14" width="14" src="images/spacer.gif" alt=""></td>
<td width="766" class="copyright">&copy; Copyright The Seasar Project and the others 2004, all rights reserved.</td>
</tr></table>
<td class="backright" align="left" valign="top">&nbsp;</td></tr><tr>
<td class="backunder" align="left"  valign="top" width="780" height="16">&nbsp;</td>
<td class="backcorner" align="left" valign="top" height="16">&nbsp;</td>
</tr></table></body>
<!-- don't edit end -->
</html>